/**************
 * Bezier Visualizer
 * License: MIT
 * Oct 2021 - present
 * PineappleRind â€” pineapplerind.xyz
 *************/

/* Looking for unobfuscated code? Try index.js :) */

!function(){let e=document.querySelector.bind(document),t=(e,t,n)=>Math.round(((1-n)*e+n*t)*100)/100;var n={lines:1,midpoints:2,trail:4,controlpoints:8,finalmidpoint:16,total(){let e=0;for(let t in n)n[t]&&"number"==typeof n[t]&&(e+=n[t]);return e},compare:e=>(a.settings.show&e)===e},a={data:[[331,351],[38,351],[331,14],[38,14],],presets:[{name:"Default",data:[[30,250],[250,250],[30,30],[250,30],],show:null},{name:"Bow",data:[[143,323],[482,25],[54,21],[113,373],[231,298],[482,25],[54,21],[279,300],[371,381],[483,25],[54,20],[357,324],],show:null},{name:"Cursive f",data:[[193,313],[513,246],[42,42],[410,6],[120,586],[567,521],[53,339],[332,283],],show:null},{name:"Music note",data:[[280,240],[119,241],[340,40],[140,40],[140,500],[400,500],[40,340],[210,340],]},{name:"Warp: infinity",data:[[683,396],[592,368],[737,382],[799,228],[764,49],[639,8],[456,144],[260,331],[97,398],[9,282],[16,91],[118,0],[288,93],[486,284],[618,384],[775,330],[796,142],[719,8],[565,50],[370,230],[158,393],[48,367],[0,198],[50,31],[185,19],[373,174],[568,353],[722,391],[796,254],[774,67],[660,2],[483,119],[285,310],[115,400],[15,306],[10,114],[100,2],[263,71],[460,259],[642,393],[765,349],[799,168],[735,17],[589,34],[396,204],[205,370],[62,380],[1,225],[38,46],[163,9],,],show:n.midpoints},{name:"Warp: circle",data:[[300,600],[552,462],[573,175],[342,3],[73,104],[12,385],[216,588],[495,528],[597,256],[424,27],[137,48],[0,301],[139,553],[426,572],[597,341],[495,72],[214,13],[12,217],[75,498],[345,597],[574,422],[551,136],[297,0],[46,140],[28,427],[260,597],[529,494],[587,212],[381,11],[101,76],[4,346],[179,574],[465,550],[600,296],[459,45],[172,29],[2,262],[107,530],[389,587],[589,380],[524,100],[252,4],[25,180],[50,467],[305,600],[555,458],[571,170],[337,2],[70,108],[14,390],[221,589],[501,523],[596,251],[419,25],[132,51],[0,307],[144,556],[431,570],[598,336],[491,69],[209,14],[10,223],[78,502],[350,596],[576,418],[548,131],[292,0],[43,145],[31,432],[266,598],[532,490],[585,207],[376,10],[97,79],[4,352],[184,577],[470,547],[600,291],[454,43],[167,31],[2,267],[111,533],[394,585],[591,375],[520,96],[247,5],[23,185],[53,471],[311,600],[558,453],[568,166],[332,2],[66,112],[16,395],[226,591],[505,519],[595,246],[414,22],[128,54],[0,312],],show:n.midpoints},],settings:{speed:.003,ease:"easeInOutQuad",show:n.total(),colorAlgorithm:"goldenAngle",noCookies:void 0}};let i={" "(){playing=!playing,g<=.01?v.clear():g>=.999&&w()},Enter(){e("#controls").classList.toggle("hidden"),e("#quickActions").classList.toggle("hidden")}};for(let l in i)document.documentElement.addEventListener("keyup",function(e){e.key===l&&i[l](e)});let o=[];var $={getData:function(){return JSON.parse(localStorage.getItem("bezierSaveData"))},set:function(){return a.noCookies?void localStorage.clear():(D(),localStorage.setItem("bezierSaveData",JSON.stringify(a)))}};$.getData()?a=$.getData():$.set();let _=t=>{e(".banner").classList.add("form-hidden"),setTimeout(function(){e(".banner").remove()},300),a.noCookies=t,$.set()};e("#bannerClose").onclick=()=>void _(!1),e("#bannerDontStore").onclick=()=>void _(!0),!1===a.noCookies&&_(!1);let r={goldenAngle:e=>`hsl(${137.50776405*e},100%,50%)`,rainbow:e=>`hsl(${20*e},100%,50%)`,grayscale:e=>`hsl(0,0%,${e/a.data.length*100}%)`};var s={easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,bounce:e=>e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375,linear:e=>e},c=[];a.data.forEach(function(e,t){c.push(r[a.settings.colorAlgorithm](t))});let d={_playing:!0,animationFrame:null,set playing(newv){window.cancelAnimationFrame(this.animationFrame),this.animationFrame=window[`${newv?"request":"cancel"}AnimationFrame`](x),e("#playBtn").innerHTML=e("#quickPlay").innerHTML=newv?"Stop":"Play",this._playing=newv},get playing(){return this._playing}},u=a.data.length-1,f=1,g=0,h=[];function p(e,t){let n=document.createElement("DIV");n.classList.add("toast",t,"showing"),n.innerHTML=e,setTimeout(()=>{n.classList.remove("showing"),setTimeout(()=>{n.remove()},500)},3e3),document.body.appendChild(n)}var m={element:e("#canvas"),context:e("#canvas").getContext("2d"),clear:function(){m.context.clearRect(0,0,m.element.width,m.element.height)}},v={element:e("#canvas2"),context:e("#canvas2").getContext("2d"),clear:function(){v.context.clearRect(0,0,v.element.width,v.element.height)}};function y(e,t){f++,c.push(r[a.settings.colorAlgorithm](f)),a.data.push([e,t]),u=a.data.length-1,P(),$.set()}function b(){m.element.setAttribute("height",window.innerHeight),m.element.setAttribute("width",window.innerWidth),v.element.setAttribute("height",window.innerHeight),v.element.setAttribute("width",window.innerWidth)}onresize=()=>{b(),P()};let k={point(e,t,n,a){m.context.beginPath(),m.context.arc(e,t,n,0,2*Math.PI,!0),m.context.closePath(),a?m.context.fillStyle=a:m.context.fillStyle="#ffffff",m.context.fill()},line(e,t,n,a){m.context.beginPath(),m.context.strokeStyle="#ffffff",m.context.moveTo(e,t),m.context.lineTo(n,a),m.context.stroke()},trail(e,a,i,l){var o,$;if(!n.compare(n.trail))return;(i||l)&&!(g<.03)||(i=e,l=a);let{context:_}=v,r=(o={x:i,y:l},Math.sqrt(Math.pow(($={x:e,y:a}).x-o.x,2)+Math.pow($.y-o.y,2)));if(r>2*Math.PI)for(let s=0;s<r;s++)_.beginPath(),_.fillStyle="#ffffff",_.arc(t(i,e,s/r),t(l,a,s/r),10,0,2*Math.PI,!0),_.fill();_.beginPath(),_.fillStyle="#ffffff",_.arc(e,a,10,0,2*Math.PI,!0),_.fill()}};function w(){g=0,v.clear(),d.playing=!1,d.playing=!0,P()}function x(){m.clear(),a.settings.ease||(a.settings.ease="quadraticEaseInOut");let i=s[a.settings.ease](g);e("#speedometer").innerHTML=e("#tValue").value=e("#tValueLabel").innerHTML=i.toFixed(3),g+=a.settings.speed,function e(n){o=Array.from({length:u=a.data.length-1},()=>[]);for(let i=0;i<u;i++)for(let l=0;l<u-i;l++){let $=0===i?a.data:o[i-1];o[i].push([t($[l][0],$[l+1][0],n),t($[l][1],$[l+1][1],n),])}}(i);let l=function e(){for(let t=0;t<o.length;t++)for(let a=0;a<o[t].length;a++){let i=3;if(t===o.length-1&&n.compare(n.finalmidpoint)&&(i=10),(n.compare(n.midpoints)||10===i&&n.compare(n.finalmidpoint))&&k.point(o[t][a][0],o[t][a][1],i),n.compare(n.lines)&&a>0&&k.line(o[t][a][0],o[t][a][1],o[t][a-1][0],o[t][a-1][1]),t===o.length-1)return[o[t][a][0],o[t][a][1]]}}();k.trail(l[0],l[1],h[0],h[1]),P(),h=l,i<0||i>=1||!1===d.playing?d.playing=!1:d.playing=!0}e("#minimize").onclick=t=>{e("#quickActions").classList.toggle("hidden"),e("#speedometer").classList.toggle("hidden"),e("#controls").classList.toggle("hidden")},e("#playBtn").onclick=e("#quickPlay").onclick=e=>{d.playing=!d.playing,g<=.01&&v.clear()},e("#replayBtn").onclick=w,e("#quickReplay").onclick=w,e("#resetCurveBtn").onclick=function e(){a.data=[[331,351],[38,351],[331,14],[38,14],],$.set()},e("#animationSpeed").oninput=t=>{e("#animationSpeedLabel").innerHTML=t.target.value,a.settings.speed=+t.target.value},e("#tValue").oninput=t=>{e("#tValueLabel").innerHTML=t.target.value,g=+t.target.value,x(),d.playing=!1};var A=!1,L=-1;function S(e){if(!0===A){var t=e.clientX,n=e.clientY;if(-1!=L){l(L);return}for(var i=0;i<a.data.length;i++)if(!0===T(t,n,i)){if(-1===L&&(L=i),t<0||n<0||t>window.innerWidth||n>window.innerHeight)break;l(i);break}}function l(e){a.data[e][0]=t,a.data[e][1]=n,m.clear(),P(),$.set()}}function I(e,t){var n=e.indexOf(t);return n>-1&&e.splice(n,1),e}function T(e,t,n){let{data:i}=a;return(e>=i[n][0]&&e<=i[n][0]+10||e<=i[n][0]&&e>=i[n][0]-10)&&(t>=i[n][1]&&t<=i[n][1]+10||t<=i[n][1]&&t>=i[n][1]-10)||L===n}function P(){let{data:e}=a;for(var t=0;t<e.length;t++)n.compare(n.lines)&&t<e.length-1&&k.line(e[t][0],e[t][1],e[t+1][0],e[t+1][1]),n.compare(n.controlpoints)&&k.point(e[t][0],e[t][1],10,c[t])}function C(){let e=document.querySelectorAll(".showCheckbox");for(let t=0;t<e.length;t++){let a=e[t];a.checked=!1,n.compare(n[a.getAttribute("id")])&&(a.checked=!0)}}function D(){e("#saveDataTextarea").value=JSON.stringify(a)}onmousedown=function(){A=!0},onmouseup=function(){A=!1,L=-1},onmousemove=S,window.ontouchmove&&window.ontouchstart&&(ontouchstart=function(){A=!0},ontouchmove=function(e){S(e.touches[0])}),m.element.ondblclick=function e(t){for(var n=t.clientX,i=t.clientY,l=0,o=0;o<a.data.length;o++){if(!0===T(n,i,o)&&a.data.length<=2){p("You can't have less than 2 points","info");break}if(!0===T(n,i,o)&&a.data.length>2)L=o,a.data=I(a.data,a.data[o]),m.clear(),$.set(),u=a.data.length-1,P(),L=-1;else{if(l++,o===a.data.length-1&&l===a.data.length-1)break;if(o===a.data.length-1&&l===a.data.length){y(n,i);break}}}},e("#easeOption").oninput=function(){a.settings.ease=e("#easeOption").value,$.set()},oninput=e=>{let t=e.target;if("TEXTAREA"===t.tagName)return;"colorOption"===t.id&&(a.settings.colorAlgorithm=e.target.value,c=[],a.data.forEach(function(e,t){c.push(r[a.settings.colorAlgorithm](t))}),$.set());let i=t.getAttribute("id");n[i]&&(a.settings.show^=n[i],$.set())},e("#animationSpeed").value=a.settings.speed,e("#colorOption").parentElement.innerHTML=function e(){let t='<select id="colorOption">';for(let n in r)selected="",a.settings.colorAlgorithm===n&&(selected="selected"),t+=`<option value="${n}" name="${n}" ${selected}>${n}</option>`;return t+"</select>"}(),e("#loadSaveDataBtn").onclick=t=>void function t(){let n=e("#saveDataTextarea");try{var i=JSON.parse(n.value)}catch(l){p(`Invalid data structure<br><small style="font-weight:200"> ${l}</small>`,"error");return}if(!i.data)return p("Invalid save code: no data","error");for(let o=0;o<i.data.length;o++)if(2!=i.data[o].length)return p(`Invalid save code <br><small style="font-weight:200">Data point ${o+1} has invalid coordinates</small>`,"error");a=i,$.set(),p("Successfully loaded save code","success")}(),e("#quickPlay").onclick=()=>{g>=.999?w():d.playing=!d.playing};var H=e("#presetSelectChoice");H.innerHTML=function e(){let t="";for(let[n,i]of a.presets.entries())t+=`<option value="${n}"${i.data===a.data?" selected":""}>${i.name}</option>`;return t}(),H.oninput=()=>{var e;let t;e=+H.value,t=a.presets[e],a.data=t.data,a.settings.show=t.show||31,w(),$.set(),C(),$.set()},C(),D(),b(),d.playing=!0}();