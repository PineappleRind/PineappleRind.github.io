"use strict";(function(){function t(t,e){let n=document.createElement("DIV");n.classList.add("toast"),n.classList.add(e),n.innerHTML=t,setTimeout(function(){n.classList.add("showing"),setTimeout(function(){n.classList.remove("showing"),setTimeout(function(){n.remove()},500)},3e3)}),document.body.appendChild(n)}function e(t,e){H++,T.push(O[settings.colorAlgorithm](H)),t=t,e=e,M.data.push([t,e]),q=data.length-1,g(),E.set()}function n(t){q=M.data.length-1,L=Array.from({length:q},()=>[]);for(let e=0;e<q;e++)for(let n=0;n<q-e;n++){let a=0===e?M.data:L[e-1];L[e].push([A(a[n][0],a[n+1][0],t),A(a[n][1],a[n+1][1],t)])}}function a(){D.element.setAttribute("height",window.innerHeight),D.element.setAttribute("width",window.innerWidth),$.element.setAttribute("height",window.innerHeight),$.element.setAttribute("width",window.innerWidth)}function i(t,e,n,a){D.context.beginPath(),D.context.arc(t,e,n,0,2*Math.PI,!0),D.context.closePath(),D.context.fillStyle=a||"#ffffff",D.context.fill()}function o(t,e,n,a){D.context.beginPath(),D.context.strokeStyle="#ffffff",D.context.moveTo(t,e),D.context.lineTo(n,a),D.context.stroke()}function l(){!0===C?(window.requestAnimationFrame(s),x("quickPlay").classList.add("playing")):(window.cancelAnimationFrame(s),x("quickPlay").classList.remove("playing")),x("playBtn").innerHTML=C?"Stop":"Play",x("quickPlay").innerHTML=C?"Stop":"Play"}function r(){C?window.cancelAnimationFrame(s):window.requestAnimationFrame(s),F=0,D.clear(),$.clear(),C=!0,g()}function s(){D.clear(),M.settings.ease||(M.settings.ease="quadraticEaseInOut"),x("speedometer").innerHTML="t="+P[M.settings.ease](F).toFixed(3),F+=M.settings.speed,n(P[M.settings.ease](F));let t=m();p(t[0],t[1],B[0],B[1]),B=t,window.cancelAnimationFrame(s),g(),F>=1||!1===C?(C=!1,l()):window.requestAnimationFrame(s)}function c(){M.data=[[331,351],[38,351],[331,14],[38,14]],E.set()}function d(t){function e(t){M.data[t][0]=n,M.data[t][1]=a,D.clear(),g(),E.set()}if(!0===W){var n=t.clientX,a=t.clientY;if(-1!=N)return void e(N);for(var i=0;i<M.data.length;i++)if(!0===h(n,a,i)){if(-1==N&&(N=i),n<0)break;if(a<0)break;if(n>window.innerWidth)break;if(a>window.innerHeight)break;e(i);break}}}function u(n){for(var a=n.clientX,i=n.clientY,o=0,l=0;l<M.data.length;l++){if(!0===h(a,i,l)&&M.data.length<=2){t("You can't have less than 2 points","info");break}if(!0===h(a,i,l)&&M.data.length>2){N=l,M.data=f(M.data,M.data[l]),D.clear(),E.set(),q=M.data.length-1,g(),N=-1;break}if(o++,l==M.data.length-1&&o==M.data.length-1)break;if(l==M.data.length-1&&o==M.data.length){e(a,i);break}}}function f(t,e){var n=t.indexOf(e);return n>-1&&t.splice(n,1),t}function h(t,e,n){const{data:a}=M;return(t>=a[n][0]&&t<=a[n][0]+10||t<=a[n][0]&&t>=a[n][0]-10)&&(e>=a[n][1]&&e<=a[n][1]+10||e<=a[n][1]&&e>=a[n][1]-10)||N===n}function g(){const{data:t,settings:e}=M;if(S.compare(S.lines))for(var n=0;n<t.length-1;n++)o(t[n][0],t[n][1],t[n+1][0],t[n+1][1]);for(n=0;n<t.length;n++)S.compare(S.controlpoints)&&i(t[n][0],t[n][1],10,T[n])}function m(){const{show:t}=M.settings;for(let t=0;t<L.length;t++)for(let e=0;e<L[t].length;e++){let n=3;if(t===L.length-1&&S.compare(S.finalmidpoint)&&(n=10),(S.compare(S.midpoints)||10==n&&S.compare(S.finalmidpoint))&&i(L[t][e][0],L[t][e][1],n),S.compare(S.lines)&&e>0&&o(L[t][e][0],L[t][e][1],L[t][e-1][0],L[t][e-1][1]),t===L.length-1)return[L[t][e][0],L[t][e][1]]}}function p(t,e,n,a){if(S.compare(S.trail))return;(!n&&!a||F<.03)&&(n=t,a=e);const{context:i}=$,o=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));let l=o({x:n,y:a},{x:t,y:e});if(l>2*Math.PI)for(let o=0;o<l;o++)i.beginPath(),i.fillStyle="#ffffff",i.arc(A(n,t,o/l),A(a,e,o/l),10,0,2*Math.PI,!0),i.fill();i.beginPath(),i.fillStyle="#ffffff",i.arc(t,e,10,0,2*Math.PI,!0),i.fill()}function w(){for(let t=0;t<document.querySelectorAll(".showCheckbox").length;t++){let e=document.querySelectorAll(".showCheckbox")[t];S.compare(S[e.getAttribute("id")])&&(console.log("Found that "+(M.settings.show>>>0).toString(2)+" has, contained within it, "+S[e.getAttribute("id")].toString(2)+", so it is checked."),e.checked=!0)}}function v(){let t,e='<select id="colorOption">\n      ';for(const n in O)t="",M.settings.colorAlgorithm===n&&(t="selected"),e+=`<option value="${n}" name="${n}" ${t}>${n}</option>\n          `;return e+="\n      </select>",e}function y(){let t=x("saveDataTextarea");t.value=JSON.stringify(M)}function b(e){e=e.previousElementSibling.previousElementSibling;try{var n=JSON.parse(e.value)}catch(e){return void t('Invalid data structure<br><small style="font-weight:200"> '+e+"</small>","error")}if(n.data.length<=1)return t("Invalid save code: no data","error","error");for(let e=0;e<n.data.length;e++)if(2!=n.data[e].length)return t('Invalid save code <br><small style="font-weight:200">Data point '+(e+1)+" has invalid coordinates</small>","error");M=n,t("Successfully loaded save code","success")}function k(){let t,e='<select id="presetChoice">\n       ';for(let n=0;n<M.presets.length;n++)t="",M.presets[n].data==M.data&&(t="selected"),e+=`<option value="${n}" ${t}>${M.presets[n].name}</option>\n           `;return e+="\n       </select>",e}const x=t=>document.getElementById(t),A=(t,e,n)=>Math.round(100*((1-n)*t+n*e))/100;var S={lines:1,midpoints:2,trail:4,controlpoints:8,finalmidpoint:16,total:()=>{let t=0;for(let e in S)S[e]&&"number"==typeof S[e]&&(t+=S[e]);return t},compare:t=>(M.settings.show&t)===t},M={data:[[331,351],[38,351],[331,14],[38,14]],presets:[{name:"Default",data:[[30,250],[250,250],[30,30],[250,30]],show:null},{name:"Bow",data:[[143,323],[482,25],[54,21],[113,373],[231,298],[482,25],[54,21],[279,300],[371,381],[483,25],[54,20],[357,324]],show:null},{name:"Cursive f",data:[[193,313],[513,246],[42,42],[410,6],[120,586],[567,521],[53,339],[332,283]],show:null},{name:"Infinity Warp",data:[[683,396],[592,368],[737,382],[799,228],[764,49],[639,8],[456,144],[260,331],[97,398],[9,282],[16,91],[118,0],[288,93],[486,284],[618,384],[775,330],[796,142],[719,8],[565,50],[370,230],[158,393],[48,367],[0,198],[50,31],[185,19],[373,174],[568,353],[722,391],[796,254],[774,67],[660,2],[483,119],[285,310],[115,400],[15,306],[10,114],[100,2],[263,71],[460,259],[642,393],[765,349],[799,168],[735,17],[589,34],[396,204],[205,370],[62,380],[1,225],[38,46],[163,9]],show:S.midpoints},{name:"Circle Warp",data:[[300,600],[552,462],[573,175],[342,3],[73,104],[12,385],[216,588],[495,528],[597,256],[424,27],[137,48],[0,301],[139,553],[426,572],[597,341],[495,72],[214,13],[12,217],[75,498],[345,597],[574,422],[551,136],[297,0],[46,140],[28,427],[260,597],[529,494],[587,212],[381,11],[101,76],[4,346],[179,574],[465,550],[600,296],[459,45],[172,29],[2,262],[107,530],[389,587],[589,380],[524,100],[252,4],[25,180],[50,467],[305,600],[555,458],[571,170],[337,2],[70,108],[14,390],[221,589],[501,523],[596,251],[419,25],[132,51],[0,307],[144,556],[431,570],[598,336],[491,69],[209,14],[10,223],[78,502],[350,596],[576,418],[548,131],[292,0],[43,145],[31,432],[266,598],[532,490],[585,207],[376,10],[97,79],[4,352],[184,577],[470,547],[600,291],[454,43],[167,31],[2,267],[111,533],[394,585],[591,375],[520,96],[247,5],[23,185],[53,471],[311,600],[558,453],[568,166],[332,2],[66,112],[16,395],[226,591],[505,519],[595,246],[414,22],[128,54],[0,312]],show:S.midpoints}],settings:{speed:.002,ease:"easeInOutQuad",show:S.total(),colorAlgorithm:"goldenAngle"}};let I={" ":()=>{C=!C,F<=.01?$.clear():F>=.99&&r(),l()},Enter:()=>{x("controls").classList.toggle("hidden"),x("quickActions").classList.toggle("hidden")}};for(const t in I)document.documentElement.addEventListener("keyup",function(e){e.key===t&&I[t](e)});let L=[];var E={getData:function(){return JSON.parse(localStorage.getItem("bezierSaveData"))},set:function(){return y(),localStorage.setItem("bezierSaveData",JSON.stringify(M))}};E.getData()?M=E.getData():E.set();let O={goldenAngle:t=>`hsl(${137.50776405*t},100%,50%)`,rainbow:t=>`hsl(${20*t},100%,50%)`,grayscale:t=>`hsl(0,0%,${t/M.data.length*100}%)`};var P={easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInOutExpo:t=>0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,bounce:t=>{const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},linear:t=>t},T=[];M.data.forEach(function(t,e){T.push(O[M.settings.colorAlgorithm](e))});let q=M.data.length-1;var C=!0,D={element:x("canvas"),context:x("canvas").getContext("2d"),clear:function(){D.context.clearRect(0,0,D.element.width,D.element.height)}},$={element:x("canvas2"),context:x("canvas2").getContext("2d"),clear:function(){$.context.clearRect(0,0,$.element.width,$.element.height)}},F=0,H=1;a(),onresize=(()=>{a(),g()}),x("minimize").onclick=(t=>{t.target.parentElement.classList.toggle("hidden"),t.target.parentElement.nextElementSibling.classList.toggle("hidden")}),x("playBtn").onclick=(t=>{C=!C,F<=.01&&$.clear(),l()}),x("replayBtn").onclick=r,x("resetCurveBtn").onclick=c,x("quickReplay").onclick=r,x("animationSpeed").oninput=(t=>M.settings.speed=t.target.value/1e3),l(),w();let B=[];var W=!1,N=-1;onmousedown=function(){W=!0},ontouchstart=function(){W=!0},onmouseup=function(){W=!1,N=-1,-1},onmousemove=function(t){d(t)},ontouchmove=function(t){d(t.touches[0])},D.element.ondblclick=(t=>{u(t)}),x("easeOption").oninput=function(){M.settings.ease=x("easeOption").value,E.set()},x("colorOption").oninput=function(){M.settings.colorAlgorithm=x("colorOption").value,T=[],M.data.forEach(function(t,e){T.push(O[M.settings.colorAlgorithm](e))}),E.set()},oninput=(t=>{let e=t.target;if("TEXTAREA"===e.tagName)return;let n=e.getAttribute("id");M.settings.show^=S[n],E.set()}),x("animationSpeed").value=1e3*M.settings.speed,x("colorOptionWrapper").innerHTML=v(),x("loadSaveDataBtn").onclick=(t=>b(t.target)),y(),x("quickPlay").onclick=(()=>{F>=.99?(r(),window.cancelAnimationFrame(s)):(C=!C,l())}),x("presetSelectChoice").innerHTML=k()})();